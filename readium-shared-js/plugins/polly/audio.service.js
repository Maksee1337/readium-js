define(['eventEmitter' ],    function(EventEmitter) {    return function (links, spansParts, jsonObjects) {        let self = this;        let _links = links;        let _spansParts = spansParts;        let _jsonObjects = jsonObjects;        let _audioSource = document.getElementById('audioSource');        let _audioPlayback = document.getElementById('audioPlayback');        let _currentAudioPartId;        let _currentAudioTime;        let _isPlaying = false;        let _interval1;        this.stopAudio = function () {            clearInterval(_interval1);            _audioPlayback.pause();        }        this.playAudio = function (id) {            const url = _links[id].url;            _currentAudioPartId = id;            _audioSource.src = url;            _audioPlayback.load();            _audioPlayback.playbackRate = 1;            document.getElementById('result').innerHTML = "Speech ready to play.";            _isPlaying = true;            _showCurrentWord();        }        let perv = {            el: {style: {color: null}},            color: null,        }        function _findWord() {            const jsonResponse = _jsonObjects[_currentAudioPartId].jsonResponse;            let word = '';            let i;            for( i = 0 ; i < jsonResponse.length ; i++) {                if(jsonResponse[i].time <= _currentAudioTime){                    word = jsonResponse[i].value;                } else {                    break;                }            }            if(i>0) {                i --;                const spine = ReadiumSDK.reader.getPaginationInfo().openPages[0];                const body = ReadiumSDK.reader.getElements(spine.idref)[1];                const id = `w${jsonResponse[i].start}x${jsonResponse[i].end}`;                const el = body.ownerDocument.getElementById(id);                if(el) {                    perv.el.style.color = perv.color;                    perv.el = el;                    perv.color = el.style.color;                    el.style.color = 'red';                    console.log(id, el);                }            }        }        function _showCurrentWord() {            _interval1 = setInterval(() => {                _currentAudioTime = `${_audioPlayback.currentTime*1000}`.split('.')[0];                _findWord();                if (_audioPlayback.currentTime === _audioPlayback.duration){                    clearInterval(_interval1);                    perv.el.style.color = perv.color;                    return;                }                console.log(_currentAudioTime);            }, 5);        }    };});