var ebookURL = "http://localhost:8080/9780192785442.epub";//var ebookURL = "http://localhost:8080/2audio.epub";var path = (window.location && window.location.pathname) ? window.location.pathname : '';// extracts path to index.html (or more generally: /PATH/TO/*.[x]html)path = path.replace(/(.*)\/.*\.[x]?html$/, "$1");path = path.charAt(path.length-1) == '/' ? path.substr(0, path.length-1) : path;var HTTPServerRootFolder =  window.location ? (        window.location.protocol        + "//"        + window.location.hostname        + (window.location.port ? (':' + window.location.port) : '')        + path    ) : '';function start() {    require(["readium_shared_js/globalsSetup", "readium_shared_js/globals"], function (GlobalsSetup, Globals) {        require(['jquery', 'readium_js/Readium'], function ($, Readium) {            var readium = undefined;            var readiumOptions =                {                    jsLibRoot: "../build-output/",                    cacheSizeEvictThreshold: undefined,                    useSimpleLoader: false, // false so we can load ZIP'ed EPUBs                    openBookOptions: {}                };            Readium.getVersion(function (version) {                var readerOptions =                    {                        needsFixedLayoutScalerWorkAround: false,                        el: "#viewport",                        annotationCSSUrl: 'http://localhost:8080/annotations.css',//"./annotations.css",                        mathJaxUrl: "/MathJax.js"                    };                    ReadiumSDK.on(ReadiumSDK.Events.PLUGINS_LOADED, function () {                        Globals.logEvent("PLUGINS_LOADED", "ON", "EpubReader.js");                        console.log('PLUGINS INITIALIZED!');                        if (readium.reader.plugins.highlights) {                            readium.reader.plugins.highlights.initialize({                                annotationCSSUrl: readerOptions.annotationCSSUrl                            });                            readium.reader.plugins.highlights.on("annotationClicked", function(type, idref, cfi, id) {                                console.debug("ANNOTATION CLICK: " + id);                                readium.reader.plugins.highlights.removeHighlight(id);                            });                        }                    });                ReadiumSDK.on(ReadiumSDK.Events.READER_INITIALIZED, function () {                    ReadiumSDK.reader.updateSettings({                        doNotUpdateView: true,                        mediaOverlaysEnableClick: false                    });                   // init();                    console.log('READER_INITIALIZED')                });                    $(document).ready(function () {                        readium = new Readium(readiumOptions, readerOptions);                        var openPageRequest = undefined; //{idref: bookmark.idref, elementCfi: bookmark.contentCFI};                        readium.openPackageDocument(                            ebookURL,                            function (packageDocument, options) {                                if (ReadiumSDK.reader.plugins.maneno){                                    ReadiumSDK.reader.plugins.maneno.init(packageDocument);                                }                                console.log(options.metadata.title);                                $('#title').text(options.metadata.title);                                if (ReadiumSDK.reader.plugins.polly){                                    ReadiumSDK.reader.plugins.polly.init();                                    ReadiumSDK.reader.plugins.polly.turnOnTTS()                                }                                if (ReadiumSDK.reader.plugins.tokenizer){                                    ReadiumSDK.reader.plugins.tokenizer.init();                                }                            },                            openPageRequest                        );                    });            });        });    });}start();